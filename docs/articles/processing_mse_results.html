<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Processing MSE Results • SablefishMSE</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Processing MSE Results">
<meta property="og:description" content="SablefishMSE">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SablefishMSE</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0.0000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/estimation_model.html">Sablefish MSE Estimation Method</a>
    </li>
    <li>
      <a href="../articles/harvest_control_rule_function.html">Harvest Control Rules</a>
    </li>
    <li>
      <a href="../articles/intro.html">Intro</a>
    </li>
    <li>
      <a href="../articles/multiple_mse_simulations.html">Multiple MSE Simulations</a>
    </li>
    <li>
      <a href="../articles/plotting_mse_results.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/processing_mse_results.html">Processing MSE Results</a>
    </li>
    <li>
      <a href="../articles/recruitment_functions.html">Specifying Recruitment</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Processing MSE Results</h1>
            
      
      
      <div class="hidden name"><code>processing_mse_results.Rmd</code></div>

    </div>

    
    
<p>The <code><a href="../reference/run_mse.html">run_mse()</a></code> and its associated wrapper functions return large quantities of data, inlcuding:</p>
<ul>
<li>Landed catch-at-age</li>
<li>Fishing mortality-at-age</li>
<li>Numbers-at-age</li>
<li>Recommended F from the harvest control rule</li>
<li>Computed TACs</li>
<li>etc.</li>
</ul>
<p>These data objects are all multi-dimensional arrays of dimensions <code>[nyears, nages, nsexes, nregions, nfleets, nsims]</code>.</p>
<p>Owing to the large number of outputs, their complex dimensions, and the frequency with which multiple MSE simulations that are compared, processing MSE results can be challenging. The <code>SablefishMSE</code> package provides a specific helper function for coercing output MSE data into a form that is useable for deriving additional quantities (e.g. spawning stock biomass), computing performance metrics, and plotting results.</p>
<div class="section level4">
<h4 id="bind_mse_results">
<code>bind_mse_results</code><a class="anchor" aria-label="anchor" href="#bind_mse_results"></a>
</h4>
<p>The function <code>bind_mse_results(model_runs, var, extra_columns)</code> takes a list of completed MSE simulation objects, a vector of variable names (as characters), and a named list of additional columns, and returns a dataframe in long-format. It is intended to be used as below:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mse1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_mse.html">run_mse</a></span><span class="op">(</span><span class="va">om</span>, <span class="va">hcr</span>, <span class="va">mse_options</span>, nyears_input<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_runs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mse1</span><span class="op">)</span></span>
<span><span class="va">extra_columns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>om<span class="op">=</span><span class="st">"hcr1"</span><span class="op">)</span></span>
<span><span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"naa"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bind_mse_outputs.html">bind_mse_outputs</a></span><span class="op">(</span><span class="va">model_runs</span>, <span class="va">vars</span>, <span class="va">extra_columns</span><span class="op">)</span></span></code></pre></div>
<p>The resulting object will be a data frame with at least six columns:</p>
<ul>
<li>time</li>
<li>age</li>
<li>sex</li>
<li>region</li>
<li>value</li>
<li>L1</li>
</ul>
<p><em>Note that the “L1” column will contain name of the variable each piece of data (“value”) is associated with. In the above example, the “L1” column will be “naa”.</em></p>
<p>If <code>extra_columns</code> are specified, additional columns will be appended to the end of the dataframe. If mse object(s) in <code>model_runs</code> contain results from multiple somulations, a “sim” column will also be a part of the dataframe. Any combination of output variables can be supplied as part of the “vars” parameter vector, though the resulting dataframe may contain <code>NA</code> entries if mixing between variables that are defined “at-age” (e.g. numbers-at-age or F-at-age), and variables that are defined annualy (e.g. TAC or recommended F from the HCR function).</p>
<p>From here, users may interact with the MSE outputs with standard R dataframe commands, or via typical tidyverse functions.</p>
</div>
<div class="section level4">
<h4 id="how-to-use-the-extra_columns-parameter">How to Use the <code>extra_columns</code> Parameter<a class="anchor" aria-label="anchor" href="#how-to-use-the-extra_columns-parameter"></a>
</h4>
<p>The <code>extra_columns</code> parameter doesn’t make a lot of sense in the above the example, as only a single MSE object is being processed. However, in the case where multiple MSE objects, with different combinations of OMs and HCRs are being processed simultaneously, users need a way to differentiate between which data belongs to which MSE simualtions. The <code>extra_columns</code> parameter provides a means for users to explicitly identfiy between MSE simulations.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mse1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_mse.html">run_mse</a></span><span class="op">(</span><span class="va">om1</span>, <span class="va">hcr1</span>, <span class="va">mse_options</span>, nyears_input<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">mse2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_mse.html">run_mse</a></span><span class="op">(</span><span class="va">om1</span>, <span class="va">hcr2</span>, <span class="va">mse_options</span>, nyears_input<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">mse3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_mse.html">run_mse</a></span><span class="op">(</span><span class="va">om2</span>, <span class="va">hcr1</span>, <span class="va">mse_options</span>, nyears_input<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">mse4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_mse.html">run_mse</a></span><span class="op">(</span><span class="va">om2</span>, <span class="va">hcr2</span>, <span class="va">mse_options</span>, nyears_input<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="va">model_runs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mse1</span>, <span class="va">mse2</span>, <span class="va">mse3</span>, <span class="va">mse4</span><span class="op">)</span></span>
<span><span class="va">extra_columns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    om <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"om1"</span>, <span class="st">"om2"</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span>
<span>    hcr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"hcr1"</span>, <span class="st">"hcr2"</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"naa"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bind_mse_outputs.html">bind_mse_outputs</a></span><span class="op">(</span><span class="va">model_runs</span>, <span class="va">vars</span>, <span class="va">extra_columns</span><span class="op">)</span></span></code></pre></div>
<p>In the above example, four MSE simulations, spanning two OMs and two HCR functions, are all being processed together (presumably for comparing the performance of the different HCRs across both OMs later on). The <code>extra_columns</code> list defines that two additional columns, “om” and “hcr” (the names of the list), should be added to the resulting output dataframe. The values of each list obect are vectors of the same length as the <code>model_runs</code> object.</p>
</div>
<div class="section level4">
<h4 id="additional-helper-functions">Additional Helper Functions<a class="anchor" aria-label="anchor" href="#additional-helper-functions"></a>
</h4>
<p>Three helper functions are provided for quickly computing common derived quantities:</p>
<ul>
<li>
<code>get_ssb_biomass()</code> - computes spawning biomass and total biomass from the true and estimated numbers-at-age matrices</li>
<li>
<code>get_fishing_mortalities()</code> - computes the fully selected fishing mortality for each fleet and jointly across all fleets from the true and estimated F-at-age matrices</li>
<li>
<code>get_recruits()</code> - computed annual recruitment from the true and estimated numbers-at-age matrices</li>
</ul>
<p>The resulting tibble from each of these function remains in long format with the appropriately columns retained. For plotting, additional processing is likely needed.</p>
<hr>
<p><em>NOTE: Additional helper functions will likely be added throughout the lifecycle of this package to streamline common calculations. A <code>get_landings()</code> function is in development to allow simplified processing of landings data.</em></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Joshua Zahner, Benjamin Williams, Dan Goethel, Curry Cunningham, Matt Cheng.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
